{% extends "base.html" %}

{% block title %}Inicio{% endblock %}

{% block content %}
  <div class="container">
    {% include "modal.html" %}
    
    <div class="row my-4"> 
        <div class="col-lg-8 col-md-10 mx-auto">
            <div class="mx-auto mb-4">
              <img src="../media/index/main-index.jpg" class"img-fluid" alt="main-index" style="height: auto; max-width: 100%;"/>
            </div>
            <div class="main-text">
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.
                Saepe nostrum ullam eveniet pariatur voluptates odit, fuga
                atque ea nobis sit soluta odio, adipisci quas excepturi maxime
                quae totam ducimus consectetur?</p>
            <br>
            
        </div>
    </div>
  </div>
{% endblock %}

{% block extrascripts %}
    <script type="text/javascript">
      function login(){
          email = document.getElementById("exampleInputUsername").value;
          password = document.getElementById("exampleInputPassword").value;
          csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
          $("#errorlogin").html("");
          $.ajax({
              type:"POST",
              url:'/login/',
              data:{
                  'csrfmiddlewaretoken': csrfmiddlewaretoken,
                  'email':email,
                  'password':password,
              },
              success : function(data){
                  console.log(data);
                  if(data['message'] == "Success"){
                      location.reload();
                  }
                  else if(data['message'] == "inactive"){
                      $("#errorlogin").html("Cuenta inactiva actualmente");
                  }
                  else{
                      $("#errorlogin").html("Revise el email y la contrase√±a");
                  }
              }
          });
      }

      function signup(){
          email = document.getElementById("exampleInputEmail").value;
          fname = document.getElementById("exampleInputFname").value;
          lname = document.getElementById("exampleInputLname").value;
          password1 = document.getElementById("exampleInputPassword1").value;
          password2 = document.getElementById("exampleInputPassword2").value;
          is_group = document.getElementById("exampleCheck1").checked;
          csrfmiddlewaretoken = document.getElementsByName("csrfmiddlewaretoken")[0].value;
          $("#erroremail").html("");
          $("#errorpass").html("");
          if(fname == "" || lname == ""){
              $("#errorname").html("Nombre y apellidos son obligatorios");
          }
          else{
          $.ajax({
          type:"POST",
          url:'/signup/',
          data:{
            'csrfmiddlewaretoken': csrfmiddlewaretoken,
            'first_name':fname,
            'last_name':lname,
            'email':email,
            'password1':password1,
            'password2':password2,
            'is_group': is_group
          },
          success : function(data){
              console.log(data['message']);
              if(data['message'] == "Success"){
                  window.location = "/"
              }
              else{
                  if("email" in data['message'])
                      $("#erroremail").html(data['message']['email'][0]);
                  if("password2" in data['message'])
                      $("#errorpass").html(data['message']['password2'][0]);
              }
          }
      })
      }
    }
    </script>
{% endblock %}